Biology Example
---------------------------

The PAC-MAN data analysis pipeline can be applied to mass-cytometry (CyTOF) data analysis. In this case, the user reads in the example data files (already saved as the Rdata format) subsetted from Bendall et al., 2011 and goes through the data analysis pipeline.

Load the required R packages

```{r Load R packages}
library(NMF) #for plotting heatmap; the user can choose to use other heatmap packages as well

library(PAC)


```

Construct the sampleIDs vector to analyze the data

```{r Load data}
sampleIDs<-c("Basal", "BCR", "IL7")

```

Partition, cluster into desired number of subpopulations, and output subpopulation mutual information networks

```{r PAC and Network Inference}
samplePass(sampleIDs, hyperrectangles=35, num_PACSupop=25, num_networkEdge=25, max.iter=50)
```

Multiple Alignments of Networks

```{r MAN}

clades_network_only<-MAN(sampleIDs, num_PACSupop=25, smallSubpopCutoff=100, k_clades=5)

```

Refine the PAC labels with multiple alignments of networks representative labels for clades

```{r refine PAC labels with MAN clade results}
refineSubpopulationLabels(sampleIDs,clades_network_only, expressionGroupClamp=5)
```

Draw clade/representative mutual information networks

```{r Clade Networks}
getRepresentativeNetworks(sampleIDs, SubpopSizeFilter=10, num_networkEdge=25)
```

Obtain annotations of subpopulations

```{r Annotation}
aggregateMatrix_withAnnotation<-annotateClades(sampleIDs, topHubs=4)
head(aggregateMatrix_withAnnotation)

```


Obtain heatmap input and plot heatmap

```{r Heatmap input and plot heatmap}
cladeProportionMatrix<-heatmapInput(aggregateMatrix_withAnnotation)
aheatmap(as.matrix(cladeProportionMatrix))
```


Append subpopulation proportions for each sample in the annotation matrix

```{r Append subpopulation proporation for each sample}
annotationMatrix_prop<-annotationMatrix_withSubpopProp(aggregateMatrix_withAnnotation)
head(annotationMatrix_prop)
```




